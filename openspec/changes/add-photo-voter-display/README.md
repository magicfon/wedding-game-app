# 照片投票者顯示功能 - OpenSpec 變更

## 變更概述

這個變更在照片管理介面中新增了投票者顯示功能。當管理員點擊照片放大查看詳情時，在操作按鈕下方會顯示所有投票給這張照片的 LINE 用戶名稱和大頭貼。

## 文件結構

```
openspec/changes/add-photo-voter-display/
├── proposal.md              # 變更提案
├── tasks.md                 # 實作任務清單
├── design.md                # 技術設計決策
├── ui-design.md             # UI 組件設計詳情
├── implementation-plan.md    # 詳細實作計劃
├── system-architecture.md   # 系統架構圖
├── README.md               # 本文件
└── specs/
    ├── admin-photos/
    │   └── spec.md        # 管理員照片介面規格
    └── photo-voting/
        └── spec.md        # 投票系統 API 規格
```

## 核心功能

### 後端 API
- **端點**: `GET /api/admin/photos/voters?photoId={id}`
- **權限**: 需要管理員權限
- **功能**: 獲取指定照片的所有投票者資訊
- **回應**: 包含用戶名稱、頭像和總投票數

### 前端 UI
- **位置**: 照片詳情彈窗的操作按鈕下方
- **布局**: 響應式網格（桌面4欄、平板3欄、手機2欄）
- **內容**: 投票者頭像和顯示名稱
- **狀態**: 支援載入、成功、錯誤和空狀態

## 技術特點

### 安全性
- 僅限管理員存取投票者資訊
- 使用現有的權限驗證機制
- 遵循資料保護原則

### 效能
- 優化的資料庫查詢
- 適當的索引利用
- 懶載入圖片

### 使用者體驗
- 流暢的載入動畫
- 友好的錯誤處理
- 響應式設計

## 實作狀態

### 已完成
- [x] 需求分析和架構設計
- [x] OpenSpec 變更提案創建
- [x] API 端點設計
- [x] UI 組件設計
- [x] 系統架構文檔

### 待實作
- [ ] 後端 API 端點實作
- [ ] 前端組件實作
- [ ] 功能測試
- [ ] 文件更新

## 驗收標準

### 功能驗收
- 管理員可以查看照片的投票者列表
- 投票者顯示正確的頭像和名稱
- 無投票者時顯示適當的空狀態
- 載入和錯誤狀態正確處理

### 效能驗收
- API 回應時間 < 500ms
- 介面載入流暢無延遲
- 大量投票者時仍保持良好效能

### 安全驗收
- 非管理員無法存取投票者資訊
- 用戶資訊不會洩露給未授權者
- 符合資料保護要求

## 風險評估

### 低風險
- 頭像載入失敗（已實作預設圖標）
- 網路錯誤（已實作重試機制）

### 中風險
- 大量投票者可能影響載入效能（已規劃優化策略）

## 下一步

1. 切換到 Code 模式
2. 實作後端 API 端點
3. 修改前端照片詳情彈窗
4. 測試功能完整性
5. 驗證 OpenSpec 規格符合性

## 相關文件

- [專案設定](../../../project.md)
- [OpenSpec 工作流程](../../../AGENTS.md)
- [照片管理介面](../../../../src/app/admin/photos/page.tsx)
- [投票系統](../../../../src/app/api/photo/vote/route.ts)