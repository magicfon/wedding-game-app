<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抽獎機 - Lottery Machine</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="viewport-container">
        <!-- Title -->
        <h1 class="title">🎰 幸運抽獎機 🎰</h1>

        <!-- Main Content Area -->
        <div class="main-content" id="mainContent">
            <!-- Winners Platform (Top Left) - End of track -->
            <div class="winners-platform" id="winnersPlatform">
                <div class="platform-surface">
                    <div class="platform-slots" id="platformSlots">
                        <!-- Winners will appear here in order -->
                    </div>
                </div>
                <div class="platform-base"></div>
            </div>

            <!-- Snake Track - Connects Funnel to Platform -->
            <div class="track-container" id="trackContainer">
                <!-- Track segments -->
                <div class="track-segment track-horizontal-1"></div>
                <div class="track-corner track-corner-1"></div>
                <div class="track-segment track-vertical-1"></div>
                <div class="track-corner track-corner-2"></div>
                <div class="track-segment track-horizontal-2"></div>
                <div class="track-corner track-corner-3"></div>
                <div class="track-segment track-vertical-2"></div>
                <div class="track-corner track-corner-4"></div>
                <div class="track-segment track-horizontal-3"></div>
            </div>

            <!-- SVG Smooth Track (Bezier Curves) -->
            <div class="track-svg-container" id="trackSvgContainer">
                <svg id="trackSvg" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="trackGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:rgba(100, 180, 255, 0.7)" />
                            <stop offset="50%" style="stop-color:rgba(150, 120, 200, 0.7)" />
                            <stop offset="100%" style="stop-color:rgba(200, 100, 150, 0.7)" />
                        </linearGradient>
                    </defs>
                    <path id="trackPathGlow" class="track-path-glow" />
                    <path id="trackPath" class="track-path" />
                </svg>
            </div>

            <!-- Node Handles Overlay (for drag editing) -->
            <div class="node-handles-overlay" id="nodeHandlesOverlay">
                <!-- Node handles will be generated dynamically -->
            </div>

            <!-- Lottery Chamber (Bottom) -->
            <div class="lottery-machine" id="lotteryMachine">
                <div class="chamber" id="chamber">
                    <div class="chamber-glass"></div>

                    <div class="photos-container" id="photosContainer">
                        <!-- Photos will be added here dynamically -->
                    </div>

                    <!-- Air vents at bottom -->
                    <div class="air-vents">
                        <div class="vent"></div>
                        <div class="vent"></div>
                        <div class="vent"></div>
                        <div class="vent"></div>
                        <div class="vent"></div>
                    </div>
                    <!-- Air bubbles effect -->
                    <div class="air-bubbles" id="airBubbles"></div>
                </div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <button class="btn btn-draw" id="drawBtn">
                <span class="btn-text">🎲 抽出得獎者</span>
                <span class="btn-glow"></span>
            </button>
            <button class="btn btn-reset" id="resetBtn">
                <span class="btn-text">🔄 重置</span>
            </button>
        </div>

        <!-- Track Editor Panel -->
        <div class="editor-panel" id="editorPanel">
            <button class="editor-toggle" id="editorToggle">⚙️ 軌道編輯器</button>
            <div class="editor-content" id="editorContent">
                <!-- Ball & Physics Settings -->
                <div class="editor-section">
                    <h3>📦 彩球與物理</h3>
                    <div class="editor-row">
                        <label>彩球直徑</label>
                        <input type="range" id="ballDiameterSlider" min="25" value="42">
                        <span id="ballDiameterValue">42</span>px
                    </div>
                    <div class="editor-row">
                        <label>重力</label>
                        <input type="range" id="gravitySlider" min="0.1" max="1.0" step="0.05" value="0.35">
                        <span id="gravityValue">0.35</span>
                    </div>
                    <div class="editor-row">
                        <label>氣流力</label>
                        <input type="range" id="airForceSlider" min="0.2" max="2.0" step="0.1" value="0.8">
                        <span id="airForceValue">0.8</span>
                    </div>
                    <div class="editor-row">
                        <label>側向氣流力</label>
                        <input type="range" id="lateralAirForceSlider" min="0" max="1.0" step="0.05" value="0.2">
                        <span id="lateralAirForceValue">0.2</span>
                    </div>
                    <div class="editor-row">
                        <label>最大速度</label>
                        <input type="range" id="maxVelocitySlider" min="5" max="30" step="1" value="15">
                        <span id="maxVelocityValue">15</span>
                    </div>
                    <!-- Hidden chamber sliders (for functionality, controlled by drag handles) -->
                    <div class="editor-row hidden">
                        <label>腔體寬度</label>
                        <input type="range" id="chamberWidthSlider" min="300" max="600" value="480">
                        <span id="chamberWidthValue">480</span>px
                    </div>
                    <div class="editor-row hidden">
                        <label>腔體高度</label>
                        <input type="range" id="chamberHeightSlider" min="150" max="350" value="220">
                        <span id="chamberHeightValue">220</span>px
                    </div>
                </div>

                <!-- Start & End Points -->
                <div class="editor-section">
                    <h3>📍 起點與終點</h3>
                    <div class="editor-row">
                        <label>起點 (漏斗)</label>
                        <span>X:</span><input type="number" id="startX" value="50" min="0" max="100">%
                        <span>Y:</span><input type="number" id="startY" value="75" min="0" max="100">%
                    </div>
                    <div class="editor-row">
                        <label>終點 (平台)</label>
                        <span>X:</span><input type="number" id="endX" value="15" min="0" max="100">%
                        <span>Y:</span><input type="number" id="endY" value="8" min="0" max="100">%
                    </div>
                </div>

                <!-- Node Editor -->
                <div class="editor-section">
                    <h3>🔗 軌道節點</h3>
                    <div class="node-path-preview" id="nodePathPreview">
                        起點 → 1 → 2 → ... → 終點
                    </div>
                    <div class="node-list" id="nodeList">
                        <!-- Nodes will be added dynamically -->
                    </div>
                    <button class="btn-add-node" id="addNodeBtn">➕ 新增節點</button>
                </div>
            </div>
            <!-- Edit Mode Toggle (below editor button) -->
            <div class="edit-mode-toggle">
                <input type="checkbox" id="editModeCheckbox">
                <label for="editModeCheckbox">🖱️ 啟用拖曳編輯模式</label>
            </div>
        </div>
    </div>

    <!-- Confetti Container -->
    <div class="confetti-container" id="confettiContainer"></div>

    <script src="script.js?v=1.3"></script>
</body>

</html>